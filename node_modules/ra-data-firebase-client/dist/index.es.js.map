{"version":3,"file":"index.es.js","sources":["../src/index.js"],"sourcesContent":["import sortBy from 'sort-by'\nconst convertFileToBase64 = file =>\n  new Promise((resolve, reject) => {\n    const reader = new FileReader()\n    reader.onload = () => resolve({result: reader.result, type: file.type, title: file.title, size: file.rawFile.size})\n    reader.onerror = reject\n    reader.readAsDataURL(file.rawFile)\n  })\nexport default (firebase, settings = {context: '', imagekey: 'images', filekey: 'files'}) => {\n  const database = firebase.default.database()\n  return {\n    create: (source, params) => {\n      const resource = [settings.context, source].join('/')\n      let uid = params.data.id || database.ref().child(resource).push().key\n\n      let create = !params.data[settings.imagekey] && !params.data[settings.filekey]\n        ? new Promise((resolve, reject) => {\n          let ref = database.ref([resource, uid].join('/'))\n          ref.set({...params.data, id: uid})\n          resolve()\n        })\n        : Promise.all((!params.data[settings.imagekey] ? [] : params.data[settings.imagekey] instanceof Array ? params.data[settings.imagekey] : [params.data[settings.imagekey]])\n          .map(img => { return {...img, type: 'image'} })\n          .map(convertFileToBase64)\n          .concat((!params.data[settings.filekey] ? [] : params.data[settings.filekey] instanceof Array ? params.data[settings.filekey] : [params.data[settings.filekey]])\n            .map(file => { return {...file, type: 'file'} }).map(convertFileToBase64)))\n          .then(base64ed =>\n            base64ed.map((item64, key) => ({\n              src: item64.result,\n              id: `${params.data.id}_${item64.type}_${key}`,\n              title: item64.title,\n              type: item64.type,\n              size: item64.size\n            }))\n          )\n          .then(transformedNewItems => {\n            database.ref([resource, uid].join('/')).set({...params.data, [settings.imagekey]: transformedNewItems.filter(i => i.type === 'image'), [settings.filekey]: transformedNewItems.filter(i => i.type === 'file'), id: uid})\n          }\n\n          )\n\n      return create.then(res => { return { data: {...params.data, id: uid} } })\n    },\n    update: (source, params) => {\n      const resource = [settings.context, source].join('/')\n      let update = !params.data[settings.imagekey] && !params.data[settings.filekey]\n        ? new Promise((resolve, reject) => {\n          database.ref([resource, params.id].join('/')).set(params.data)\n          resolve()\n        })\n        : Promise.all((!params.data[settings.imagekey] ? [] : params.data[settings.imagekey] instanceof Array ? params.data[settings.imagekey] : [params.data[settings.imagekey]])\n          .filter(\n            p => p.rawFile instanceof File\n          ).map(img => { return {...img, type: 'image'} }).map(convertFileToBase64)\n          .concat((!params.data[settings.filekey] ? [] : params.data[settings.filekey] instanceof Array ? params.data[settings.filekey] : [params.data[settings.filekey]])\n            .filter(\n              p => p.rawFile instanceof File\n            ).map(file => { return {...file, type: 'file'} }).map(convertFileToBase64)))\n          .then(base64ed =>\n            base64ed.map((item64, key) => ({\n\n              src: item64.result,\n              id: `${params.data.id}_${item64.type}_${key}`,\n              title: item64.title,\n              type: item64.type,\n              size: item64.size\n            }))\n          )\n          .then(transformedNewItems => {\n            database.ref([resource, params.id].join('/')).set({\n              ...params.data,\n              [settings.imagekey]: [\n                ...transformedNewItems.filter(i => i.type === 'image'),\n                ...(!params.data[settings.imagekey] ? [] : params.data[settings.imagekey] instanceof Array ? params.data[settings.imagekey] : [params.data[settings.imagekey]]).filter(\n                  p => !(p.rawFile instanceof File)\n                )\n              ],\n              [settings.filekey]: [\n                ...transformedNewItems.filter(i => i.type === 'file'),\n                ...(!params.data[settings.filekey] ? [] : params.data[settings.filekey] instanceof Array ? params.data[settings.filekey] : [params.data[settings.filekey]]).filter(\n                  p => !(p.rawFile instanceof File)\n                )\n              ]\n            })\n          }\n\n          )\n      return update.then(res => { return { data: params.data } })\n    },\n    getList: async (source, params) => {\n      const resource = [settings.context, source].join('/')\n      const { field } = params.sort\n      let ref = database.ref(resource)\n      return ref.orderByChild(field)\n        .once('value').then(function(snapshot) {\n          let valuesToReturn = snapshot.val() ? Object.values(snapshot.val()) : []\n          if (params.filter) {\n            let filterset = params.filter\n            filterset = Object.assign(filterset, filterset.q ? {id: filterset.q} : {})\n            delete filterset.q\n            const filters = Object.entries(filterset)\n            filters.forEach(([filterKey, filterValue]) => {\n              valuesToReturn = valuesToReturn.filter(value => {\n                if (value && value[filterKey] && typeof value[filterKey] !== 'object') {\n                  const propsToFilter = `${value[filterKey]}`.toLowerCase()\n                  if (propsToFilter.includes(`${filterValue}`.toLowerCase())) {\n                    return true\n                  }\n                }\n                return false\n              })\n            })\n          }\n\n          if (params.pagination) {\n            let values = []\n            values = valuesToReturn\n            if (params.sort) {\n              values.sort(sortBy(`${params.sort.order === 'ASC' ? '-' : ''}${params.sort.field}`))\n            }\n            const { page, perPage } = params.pagination\n            const _start = (page - 1) * perPage\n            const _end = page * perPage\n            const data = values ? values.slice(_start, _end) : []\n            const total = snapshot.val() ? Object.keys(snapshot.val()).length : 0\n\n            return { data, total }\n          } else {\n            throw new Error('Error processing request')\n          }\n        })\n    },\n\n    getOne: async (source, params) => {\n      const resource = [settings.context, source].join('/')\n      let ref = await database.ref([resource, params.id].join('/'))\n      return ref.once('value').then(function(snapshot) {\n        return {\n          data: snapshot.val()}\n      })\n    },\n\n    getMany: (source, params) => {\n      const resource = [settings.context, source].join('/')\n      let getMany = new Promise((resolve, reject) => {\n        let data = params.ids.map(id => {\n          return database.ref([resource, id].join('/')).once('value').then(function(snapshot) {\n            return snapshot.val()\n          })\n        })\n        resolve(data)\n      })\n      return getMany.then(data => { return { data: data } })\n    },\n\n    getManyReference: (source, params) => {\n      const resource = [settings.context, source].join('/')\n      let getManyRef = new Promise((resolve, reject) => {\n        let data = params.ids.map(id => {\n          return database.ref([resource, id].join('/')).once('value').then(function(snapshot) {\n            return snapshot.val()\n          })\n        })\n        resolve(data)\n      })\n      return getManyRef.then(data => { return { data: data } })\n    },\n\n    updateMany: async (source, params) => {\n      const resource = [settings.context, source].join('/')\n      let updateMany = new Promise((resolve, reject) => {\n        params.ids.map(id => {\n          database.ref([resource, id].join('/')).once('value').then(function(snapshot) {\n            let update = new Promise((resolve, reject) => {\n              database.ref([resource, id].join('/')).set(Object.assign(snapshot.val(), params.data))\n              resolve()\n            })\n            return update.then(res => { return { data: params.data } })\n          })\n        })\n        resolve()\n      })\n      return updateMany.then(res => { return { data: params.ids } })\n    },\n\n    delete: (source, params) => {\n      const resource = [settings.context, source].join('/')\n      let Delete = new Promise((resolve, reject) => {\n        database.ref([resource, params.id].join('/')).set(null)\n        resolve()\n      })\n      return Delete.then(res => { return { data: params.previousData } })\n    },\n\n    deleteMany: (source, params) => {\n      const resource = [settings.context, source].join('/')\n      let deleteMany = new Promise((resolve, reject) => {\n        params.ids.map(id => database.ref([resource, id].join('/')).set(null))\n        resolve()\n      })\n      return deleteMany.then(res => { return { data: params } })\n    }\n  }\n}\n"],"names":["convertFileToBase64","Promise","resolve","reject","reader","FileReader","onload","result","type","file","title","size","rawFile","onerror","readAsDataURL","firebase","settings","context","imagekey","filekey","database","default","create","source","params","resource","join","uid","data","id","ref","child","push","key","set","all","Array","map","img","concat","then","base64ed","item64","src","transformedNewItems","filter","i","update","p","File","getList","field","sort","orderByChild","once","snapshot","valuesToReturn","val","Object","values","filterset","assign","q","filters","entries","forEach","filterKey","filterValue","value","babelHelpers.typeof","propsToFilter","toLowerCase","includes","pagination","sortBy","order","page","perPage","_start","_end","slice","total","keys","length","Error","getOne","getMany","ids","getManyReference","getManyRef","updateMany","delete","Delete","previousData","deleteMany"],"mappings":"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"}